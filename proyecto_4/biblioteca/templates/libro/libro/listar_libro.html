{% extends 'index.html' %}

{% block titulo %}
    Listado de Libros
{% endblock titulo %}

{% block titulo_central %} 
    <h2 class="title-1"> Listado Libros</h2>
{% endblock titulo_central %}
{% block extracss %}
    <style>
        #edicion {
          position:absolute; z-index: 3;
        }
    </style>

{% endblock extracss %}

{% block body %}


    {% if libros %}

    <div class="table-responsive m-b-40">
        <table class="table table-borderless table-data3">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Titulo</th>
                    <th>Autor</th>
                    <th>Fecha de publicaci√≥n</th>                    
                    <th>Opciones</th>
                </tr>
            </thead>
            <tbody>
                {% for libro in libros %}
                    <tr>
                        <td>{{ libro.id }}</td>
                        <td>{{ libro.titulo }}</td>                        
                        <td>
                            {% for autor in libro.autor_id.all %}
                                <li>{{ autor.nombre }}</li>
                            {% endfor %}
                        </td> 
                        <td>{{ libro.fecha_publicacion }}</td>                       
                        <td colspan="2">
                            <div class="d-grid d-md-flex">
                            <button onclick="abrir_modal_edicion('{% url 'libro:editar_libro' libro.id %}')" class="btn btn-primary" >Editar</button>
                            <a href="{% url 'libro:eliminar_libro' libro.id %}" class="btn btn-danger" role="button">Eliminar</a>
                            </div>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

       
    {% else %}
        <h1>No existen libros registrados</h1>
    {% endif %}

    <form method="POST">
        {% csrf_token %}
        <div class="card">
            <div class="card-header">
                <strong>Formulario de Registro</strong>
            </div>
            <div class="card-body card-block">
                
                {{ form.as_p }}
               
            </div>           
        </div>
        <button type="submit" class="btn-success btn-lg">Registrar</button>
    </form>

    <div class="modal fade"  id="edicion"  role="dialog">

    </div>

{% endblock body %}
 
{% block extrajs %}
<script type="text/javascript">
    var $ = jQuery.noConflict();
    function abrir_modal_edicion(url) {
        $('#edicion').load(url, function() {
            $(this).modal('show');
        });
    }
    
</script>
{% endblock extrajs %}